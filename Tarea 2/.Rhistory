library(tidyverse)
stock = read_tsv("Stock1LOB.txt")
View(stock)
View(stock)
#Cálculo horquilla relativa
sum(unique(stock$sign))
unique(stock$sign)
count(unique(stock$sign))
sum(unique(stock$sign))
count(unique(stock$sign))
#Cálculo horquilla relativa
count(unique(as.factor(stock$sign)))
#Cálculo horquilla relativa
count(unique(as.character(stock$sign)))
#Cálculo horquilla relativa
stock$sign[i]
#Cálculo horquilla relativa
stock$sign[1]
#Cálculo horquilla relativa
stock$time
#Cálculo horquilla relativa
?group_by()
#Cálculo horquilla relativa
group_by(stock, time)
View(stock)
#Cálculo horquilla relativa
stock2 = group_by(stock, time)
View(stock2)
library(tidyverse)
stock = read_tsv("Stock1LOB.txt")
View(stock)
#Cálculo horquilla relativa
stock$time
#Cálculo horquilla relativa
unique(stock$time)
#Cálculo horquilla relativa
count(unique(stock$time))
#Cálculo horquilla relativa
nrow(unique(stock$time))
#Cálculo horquilla relativa
count(c(unique(stock$time)))
#Cálculo horquilla relativa
sum(unique(stock$time))
#Cálculo horquilla relativa
time = unique(stock$time)
i=1
stock$time[i]
stock$time == stock$time[i]
stock[which(stock$time == stock$time[i]),]
unique(stock$date)
nrow(stock[which(stock$time == stock$time[i]),])
nrow(stock[which(stock$time == stock$time[i]),])
for (i in 1:389){
nrow(stock[which(stock$time == stock$time[i]),])
}
print(nrow(stock[which(stock$time == stock$time[i]),]))
for (i in 1:389){
print(nrow(stock[which(stock$time == stock$time[i]),]))
}
j=1
stock[which(stock$time == stock$time[j] && stock$date == stock$date[i]),]
stock$date == stock$date[i]
stock$time == stock$time[j] && stock$date == stock$date[i]
stock$time == stock$time[j]
stock$time == stock$time[j] & stock$date == stock$date[i]
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i]),]
stock = read_tsv("Stock201LOB.txt")
View(stock)
#Se crean todas las variables que serán necesarias en el algoritmo
time = unique(stock$time)
count(time)
num(time)
ncol(time)
values(time)
lenght(time)
length(time)
1:length(time)
unique(stock$date)
length(unique(stock$date))
which(stock$time == stock$time[j] & stock$date == stock$date[i]
(stock$time == stock$time[j] & stock$date == stock$date[i])
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i]),]
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == 1),]$dvol
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == 1),]$dvol
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == 1),]$quote
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1,2)),]$dvol
sum(stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1,2)),]$dvol)
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == 1),]$dvol +
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == 1),]$hvol
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == 1),]$hvol
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == 1),]$dvol +
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == 1),]$hvol
c = c(1,2,3)
c[4]
c = c(-10:10)
c
c = c(-1:-10)
c
c= c(1:1)
c
l=2
k=100
(stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:l)),]$dvol +
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:l)),]$hvol)  >= k
(stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:l)),]$dvol +
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:l)),]$hvol)
sum(stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:l)),]$dvol,
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:l)),]$hvol)
sum(stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:l)),]$dvol,
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:l)),]$hvol)  >= k
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:l)),]$dvol
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:l)),]$hvol)
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:l)),]$hvol
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:l-1)),]$dvol +
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:l-1)),]$hvol)  !>= k
(stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:l-1)),]$dvol +
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:l-1)),]$hvol)  >= k)
(stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:l-1)),]$dvol +
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:l-1)),]$hvol)  >= k
l-1
1:l-1
c(1:l-1)
c(1:l)
(stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:l-1)),]$dvol +
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:l-1)),]$hvol)
(l-1)
1:(l-1))
c(1:(l-1))
(stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$dvol +
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$hvol)
sum(stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$dvol,
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$hvol)
sum(stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$dvol,
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$hvol)  >= k
!(sum(stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$dvol,
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$hvol)  >= k)
sum(stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:l)),]$dvol,
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:l)),]$hvol)  >= k &
!(sum(stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$dvol,
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$hvol)  >= k)
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == 1),]$quote
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1,2)),]$quote
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1,2)),]$quote *
(stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1,2)),]$dvol
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1,2)),]$quote *
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1,2)),]$dvol
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1,2)),]$dvol
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:l)),]$dvol
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:l)),]$dvol[,2]
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:l)),]$dvol[2]
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$dvol
stock[1]$dvol = 50
stock[1]$dvol
stock$dvol[1]
stock$dvol[1] = 50
stock$dvol[2] = 20
sum(stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:l)),]$dvol,
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:l)),]$hvol)  >= k &
!(sum(stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$dvol,
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$hvol)  >= k)
l=1
sum(stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:l)),]$dvol,
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:l)),]$hvol)  >= k &
!(sum(stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$dvol,
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$hvol)  >= k)
sum(stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:l)),]$dvol,
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:l)),]$hvol)  >= k
l=3
sum(stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:l)),]$dvol,
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:l)),]$hvol)  >= k &
!(sum(stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$dvol,
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$hvol)  >= k)
stock$sign == c(1:l)
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$quote
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$dvol
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(l)),]$quote
(k - sum(stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$dvol))
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1)),]$dvol +
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == 1),]$hvol
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$quote *
(stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$dvol +
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$hvol)
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(l)),]$quote *
(k - sum(stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$dvol,
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$hvol))
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(l)),]$quote
sum(stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$quote *
(stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$dvol +
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$hvol),
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(l)),]$quote *
(k - sum(stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$dvol,
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$hvol)))
b = sum(stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$quote *
(stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$dvol +
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$hvol),
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(l)),]$quote *
(k - sum(stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$dvol,
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$hvol)))/k
l=4
sum(stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:l)),]$dvol,
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:l)),]$hvol)  >= k &
!(sum(stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$dvol,
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$hvol)  >= k)
hor_rel = matrix(nrow = length(unique(stock$time)), ncol = 3)
rownames(matrix)
rownames(matrix)[1] = "h"
rownames(matrix)[1,1] = "h"
rownames(matrix[1,1]) = "h"
rownames(matrix[1]) = "h"
matrix[1]
?rownames
rownames(matrix[1]) = h
rownames(matrix[1]) = "h"
rownames(matrix)[1] = "h"
rownames(hor_rel)[1] = "h"
rownames(hor_rel)[1,1] = "h"
rownames(hor_rel[1]) = "h"
rownames(hor_rel) = "h"
rownames(hor_rel)[1] = "h"
rowname(hor_rel)[1] = "h"
rownames(hor_rel)[1] = "h"
Rownames(hor_rel)[1] = "h"
cbind(unique(stock$date),unique(stock$time))
hor_rel[(j*i),m]
m=1
hor_rel[(j*i),m]
(j*i)
hor_rel[(j*i),m] = 2
hor_rel[(j*i),m]
hor_rel[389,m]
hor_rel = matrix(nrow = (length(unique(stock$date)) * length(unique(stock$time))), ncol = 3)
#Cálculo horquilla relativa
for (i in 1:length(unique(stock$date))){
for (j in 1:length(unique(stock$time))){
m=1
for (k in c(100,500,1000)){
for(l in 1:10){
if(sum(stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:l)),]$dvol,
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:l)),]$hvol)  >= k &
!(sum(stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$dvol,
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$hvol)  >= k)){
hor_rel[(j*i),m] = sum(stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$quote *
(stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$dvol +
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$hvol),
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(l)),]$quote *
(k - sum(stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$dvol,
stock[which(stock$time == stock$time[j] & stock$date == stock$date[i] & stock$sign == c(1:(l-1))),]$hvol)))/k
}
}
m = m + 1
}
}
}
